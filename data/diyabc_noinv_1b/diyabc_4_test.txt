 ############## MODEL CHOICE analysis using random forest ###############  

Name of the statobs file: statobsRF.txt 
Number of statobs in the file = 1 
Name of the reference table file: reftableRF.bin 
Name of the headerfile file: headerRF.txt 
Number of simulations loaded from the reference table = 80000 
Number of scenarios (i.e. models) in the reference table = 8 
Number of simulations available for each scenario from the loaded reference table = 9987 9811 10009 9982 10246 9925 10069 9971 
Number of parameters in the reference table = 10 12 12 12 13 13 13 14 
Number of summary statistics in the reference table (without LDA axes) = 130 
Number of simulations in the TRAINING DATASET used to built rf trees = 80000 
Number of trees in the forest = 1000 
Number of cores available =  128 
Number of cores used for computation = 126 
Analysis of each scenario independently (no grouping or selelection of scenarios) 
Number of ANALYSED scenarios (i.e. models) using RF = 8 
n.run = 1 

############################################################################################# 
--------------------> i.run = 1 


RF TRAINING step using all scenarios separately 
Growing trees.. Progress: 9%. Estimated remaining time: 5 minutes, 33 seconds.
Growing trees.. Progress: 22%. Estimated remaining time: 3 minutes, 42 seconds.
Growing trees.. Progress: 35%. Estimated remaining time: 2 minutes, 52 seconds.
Growing trees.. Progress: 49%. Estimated remaining time: 2 minutes, 10 seconds.
Growing trees.. Progress: 62%. Estimated remaining time: 1 minute, 34 seconds.
Growing trees.. Progress: 77%. Estimated remaining time: 56 seconds.

PRIOR ERROR RATES (using the Out-of-Bag statistical procedure): we provide mean Out-of-Bag prior error rate and matrix of errors with the true scenario number as rows and the chosen scenarios as columns 

Call:
 abcrf(formula = scenario ~ ., data = dataTrain, lda = TRUE, ntree = ntree, paral = TRUE, ncores = how.many.cores.used.for.computation, min.node.size = 1, save.memory = FALSE) 
includes the axes of a preliminary LDA

Number of simulations: 80000
Out-of-bag prior error rate: 57.24%

Confusion matrix:
     1    2    3    4    5    6    7    8 class.error
1 7963  275  281  273  283  319  379  214   0.2026635
2 1022 3790  901  492 1623  413  811  759   0.6136989
3 1066  840 3897  631 1649  794  475  657   0.6106504
4  378  163  229 8093  205  378  368  168   0.1892406
5 1039 2029 2106  554 2477  562  640  839   0.7582471
6 1154  392 1142  731  681 3201 1806  818   0.6774811
7 1149 1073  468  565  645 1618 3521 1030   0.6503128
8 1125 1469  958  571 1259 1385 1938 1266   0.8730318
Numerical values of Importance Measures of the summary statistics (i.e. explanatory variables) are stored in the file named importance_measures_of_summary statistics_SORTED.txt 

RF MODEL CHOICE PREDICTION on the observed dataset(s): we provide the index of the selected model (i.e. scenario), the votes for each model (over the total number of trees in the forest) and the posterior probability for the selected model 
 selected model votes model1 votes model2 votes model3 votes model4
              6           26           40           87          136
 votes model5 votes model6 votes model7 votes model8 post.proba
           48          318          187          158      0.429



############################################################################################# 
############################################################################################# 
ABSTRACT over the n.run for each vector of STATOBS 
############################################################################################# 
############################################################################################# 

Recalling what are the different statobs lines 
Statobs_1 =     ML1p_1        ML1p_2        ML1p_3        ML1p_4       ML2p_1.2      ML2p_1.3      ML2p_1.4      ML2p_2.3      ML2p_2.4      ML2p_3.4     ML3p_1.2.3    ML3p_1.2.4    ML3p_1.3.4    ML3p_2.3.4      HWm_1         HWm_2         HWm_3         HWm_4         HWv_1         HWv_2         HWv_3         HWv_4        HBm_1.2       HBm_1.3       HBm_1.4       HBm_2.3       HBm_2.4       HBm_3.4       HBv_1.2       HBv_1.3       HBv_1.4       HBv_2.3       HBv_2.4       HBv_3.4       FST1m_1       FST1m_2       FST1m_3       FST1m_4       FST1v_1       FST1v_2       FST1v_3       FST1v_4      FST2m_1.2     FST2m_1.3     FST2m_1.4     FST2m_2.3     FST2m_2.4     FST2m_3.4     FST2v_1.2     FST2v_1.3     FST2v_1.4     FST2v_2.3     FST2v_2.4     FST2v_3.4      NEIm_1.2      NEIm_1.3      NEIm_1.4      NEIm_2.3      NEIm_2.4      NEIm_3.4      NEIv_1.2      NEIv_1.3      NEIv_1.4      NEIv_2.3      NEIv_2.4      NEIv_3.4     AMLm_1.2.3    AMLm_2.1.3    AMLm_3.1.2    AMLm_1.2.4    AMLm_2.1.4    AMLm_4.1.2    AMLm_1.3.4    AMLm_3.1.4    AMLm_4.1.3    AMLm_2.3.4    AMLm_3.2.4    AMLm_4.2.3    AMLv_1.2.3    AMLv_2.1.3    AMLv_3.1.2    AMLv_1.2.4    AMLv_2.1.4    AMLv_4.1.2    AMLv_1.3.4    AMLv_3.1.4    AMLv_4.1.3    AMLv_2.3.4    AMLv_3.2.4    AMLv_4.2.3   FST3m_1.2.3   FST3m_1.2.4   FST3m_1.3.4   FST3m_2.3.4   FST3v_1.2.3   FST3v_1.2.4   FST3v_1.3.4   FST3v_2.3.4   FST4m_1.2.3.4  FST4v_1.2.3.4   F3m_1.2.3     F3m_2.1.3     F3m_3.1.2     F3m_1.2.4     F3m_2.1.4     F3m_4.1.2     F3m_1.3.4     F3m_3.1.4     F3m_4.1.3     F3m_2.3.4     F3m_3.2.4     F3m_4.2.3     F3v_1.2.3     F3v_2.1.3     F3v_3.1.2     F3v_1.2.4     F3v_2.1.4     F3v_4.1.2     F3v_1.3.4     F3v_3.1.4     F3v_4.1.3     F3v_2.3.4     F3v_3.2.4     F3v_4.2.3    F4m_1.2.3.4   F4m_1.3.2.4   F4m_1.4.2.3   F4v_1.2.3.4   F4v_1.3.2.4   F4v_1.4.2.3  

Summary for Statobs = 1 
       S1           S2           S3           S4            S5    
 Min.   :26   Min.   :40   Min.   :87   Min.   :136   Min.   :48  
 1st Qu.:26   1st Qu.:40   1st Qu.:87   1st Qu.:136   1st Qu.:48  
 Median :26   Median :40   Median :87   Median :136   Median :48  
 Mean   :26   Mean   :40   Mean   :87   Mean   :136   Mean   :48  
 3rd Qu.:26   3rd Qu.:40   3rd Qu.:87   3rd Qu.:136   3rd Qu.:48  
 Max.   :26   Max.   :40   Max.   :87   Max.   :136   Max.   :48  
       S6            S7            S8           Prob            Win   
 Min.   :318   Min.   :187   Min.   :158   Min.   :0.429   Min.   :6  
 1st Qu.:318   1st Qu.:187   1st Qu.:158   1st Qu.:0.429   1st Qu.:6  
 Median :318   Median :187   Median :158   Median :0.429   Median :6  
 Mean   :318   Mean   :187   Mean   :158   Mean   :0.429   Mean   :6  
 3rd Qu.:318   3rd Qu.:187   3rd Qu.:158   3rd Qu.:0.429   3rd Qu.:6  
 Max.   :318   Max.   :187   Max.   :158   Max.   :0.429   Max.   :6  
  Prior_error    
 Min.   :0.5724  
 1st Qu.:0.5724  
 Median :0.5724  
 Mean   :0.5724  
 3rd Qu.:0.5724  
 Max.   :0.5724  



Winner scenarios for Statobs = 1 
[1] 6



  Win.Scen.ID occur
1           6     1

Mean vote numbers for each statobs 

Statobs # 1 
  Scenario Mean.Votes
1        1         26
2        2         40
3        3         87
4        4        136
5        5         48
6        6        318
7        7        187
8        8        158


Final results without threshold:
Global mean number of votes over all statobs:
  Scenario Mean.Votes
1        1         26
2        2         40
3        3         87
4        4        136
5        5         48
6        6        318
7        7        187
8        8        158

### End of Results ###
############################################################################################# 
############################################################################################# 
########### OTHER PRESENTATION OF FINAL RESULTS WITHOUT ANY THRESHOLD ###################### 
############################################################################################# 
############################################################################################# 

DataFrame for mean number of votes with TotalTrees row 
    Scenario Statobs1
1          1       26
2          2       40
3          3       87
4          4      136
5          5       48
6          6      318
7          7      187
8          8      158
9 TotalTrees     1000
nDataFrame for mean fraction of votes with Total% row 
       Scenario Statobs1
1             1    0.026
2             2    0.040
3             3    0.087
4             4    0.136
5             5    0.048
6             6    0.318
7             7    0.187
8             8    0.158
9 TotalFraction    1.000

### End of Results ###
############################################################################################# 
############################################################################################# 
########### OTHER PRESENTATION OF FINAL RESULTS USING A DEFINED THRESHOLD          ########## 
############################################################################################# 
############################################################################################# 
ntree = 1000 
results_threshold_fraction_trees= 0.05 
threshold in min number of trees = 50 

Sub-dataframe for the scenarios with mean number of votes >  50 
  Scenario Statobs1
3        3       87
4        4      136
6        6      318
7        7      187
8        8      158

Sub-dataframe for the scenarios with mean fraction of votes >  0.05 
  Scenario Statobs1
3        3    0.087
4        4    0.136
6        6    0.318
7        7    0.187
8        8    0.158

Sum of the nbre of votes for scenario relaining after threshold 
           Column Sum
Statobs1 Statobs1 886

Sum of the nbre of votes for scenario relaining after threshold 
           Column   Sum
Statobs1 Statobs1 0.886
############################################################################################# 
Drawing figures for the last of the i.run = 1 
############################################################################################# 
Press <ENTER> to Continue
THREE ILLUSTRATIVE GRAPHICS have been produced and saved in three different files: FALSEFile named prior_errors_vs_number_of_trees.png: Graphic providing prior error rates for forests with different number of trees and computed using an Out-of-Bag procedure, e.g. Fig. 3 in Pudlo et al. 2016 
File named graph_lda.pdf = LDA projections of the reference table for the different scenarios plus the observed dataset cf. black star in the figure 
File name graph_varImpPlot.pdf = the contributions of the 30 most important statistics to the RF (e.g. Fig. S6 and Fig. S7 in Pudlo et al. 2016) 
