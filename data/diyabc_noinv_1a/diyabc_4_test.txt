############## MODEL CHOICE analysis using random forest ###############  

Name of the statobs file: statobsRF.txt 
Number of statobs in the file = 1 
Name of the reference table file: reftableRF.bin 
Name of the headerfile file: headerRF.txt 
Number of simulations loaded from the reference table = 140000 
Number of scenarios (i.e. models) in the reference table = 14 
Number of simulations available for each scenario from the loaded reference table = 10175 9986 9935 10102 10067 9855 10063 9989 10012 9840 9966 10056 10164 9790 
Number of parameters in the reference table = 10 10 10 10 10 10 10 12 12 12 13 13 13 14 
Number of summary statistics in the reference table (without LDA axes) = 130 
Number of simulations in the TRAINING DATASET used to built rf trees = 140000 
Number of trees in the forest = 1000 
Number of cores available =  128 
Number of cores used for computation = 126 
Analysis of each scenario independently (no grouping or selelection of scenarios) 
Number of ANALYSED scenarios (i.e. models) using RF = 14 
n.run = 1 

############################################################################################# 
--------------------> i.run = 1 


RF TRAINING step using all scenarios separately 
Growing trees.. Progress: 0%. Estimated remaining time: 18 hours, 52 minutes, 12 seconds.
Growing trees.. Progress: 13%. Estimated remaining time: 16 minutes, 29 seconds.
Growing trees.. Progress: 24%. Estimated remaining time: 9 minutes, 17 seconds.
Growing trees.. Progress: 25%. Estimated remaining time: 10 minutes, 20 seconds.
Growing trees.. Progress: 30%. Estimated remaining time: 9 minutes, 30 seconds.
Growing trees.. Progress: 38%. Estimated remaining time: 7 minutes, 34 seconds.
Growing trees.. Progress: 38%. Estimated remaining time: 8 minutes, 12 seconds.
Growing trees.. Progress: 48%. Estimated remaining time: 6 minutes, 3 seconds.
Growing trees.. Progress: 50%. Estimated remaining time: 6 minutes, 9 seconds.
Growing trees.. Progress: 56%. Estimated remaining time: 5 minutes, 18 seconds.
Growing trees.. Progress: 62%. Estimated remaining time: 4 minutes, 23 seconds.
Growing trees.. Progress: 65%. Estimated remaining time: 4 minutes, 17 seconds.
Growing trees.. Progress: 73%. Estimated remaining time: 3 minutes, 9 seconds.
Growing trees.. Progress: 76%. Estimated remaining time: 2 minutes, 52 seconds.
Growing trees.. Progress: 80%. Estimated remaining time: 2 minutes, 17 seconds.
Growing trees.. Progress: 87%. Estimated remaining time: 1 minute, 29 seconds.
Growing trees.. Progress: 91%. Estimated remaining time: 1 minute, 3 seconds.

PRIOR ERROR RATES (using the Out-of-Bag statistical procedure): we provide mean Out-of-Bag prior error rate and matrix of errors with the true scenario number as rows and the chosen scenarios as columns 

Call:
 abcrf(formula = scenario ~ ., data = dataTrain, lda = TRUE, ntree = ntree, paral = TRUE, ncores = how.many.cores.used.for.computation, min.node.size = 1, save.memory = FALSE) 
includes the axes of a preliminary LDA

Number of simulations: 140000
Out-of-bag prior error rate: 75.0071%

Confusion matrix:
      1    2    3    4    5    6    7    8    9   10   11   12   13   14
1  1393 1305 1178 1376 1340 1213 1361  152  141  198  112  166  152   88
2  1415 1261 1140 1370 1344 1194 1318  140  131  158  109  182  144   80
3  1428 1193 1206 1334 1240 1167 1308  159  140  191  104  183  199   83
4  1367 1261 1228 1423 1340 1199 1328  129  126  178   96  168  164   95
5  1413 1325 1159 1412 1242 1217 1346  124  123  177  116  171  157   85
6  1400 1346 1149 1367 1259 1175 1212  130  111  178  117  162  177   72
7  1478 1267 1251 1347 1273 1120 1352  143  110  200  110  156  159   97
8   258  207  226  229  196  190  240 4039  888  389 1357  374  767  629
9   262  211  215  197  210  209  214  897 3933  558 1376  776  479  475
10  117   51   73   99   65   68   84  135  183 7969   90  410  356  140
11  256  224  191  196  200  174  196 2115 2018  469 2122  543  599  663
12  277  259  244  240  246  237  263  388 1155  588  550 3166 1714  729
13  294  213  242  271  215  206  234 1139  459  493  519 1438 3472  969
14  239  219  204  247  204  200  228 1543  847  487 1046 1281 1808 1237
   class.error
1    0.8630958
2    0.8737232
3    0.8786110
4    0.8591368
5    0.8766266
6    0.8807712
7    0.8656464
8    0.5956552
9    0.6071714
10   0.1901423
11   0.7870761
12   0.6851631
13   0.6584022
14   0.8736466
Numerical values of Importance Measures of the summary statistics (i.e. explanatory variables) are stored in the file named importance_measures_of_summary statistics_SORTED.txt 

Growing trees.. Progress: 55%. Estimated remaining time: 25 seconds.
RF MODEL CHOICE PREDICTION on the observed dataset(s): we provide the index of the selected model (i.e. scenario), the votes for each model (over the total number of trees in the forest) and the posterior probability for the selected model 
 selected model votes model1 votes model2 votes model3 votes model4
             12            7            5            6            8
 votes model5 votes model6 votes model7 votes model8 votes model9 votes model10
            5            6            6           31          117            73
 votes model11 votes model12 votes model13 votes model14 post.proba
            49           356           183           148      0.437



############################################################################################# 
############################################################################################# 
ABSTRACT over the n.run for each vector of STATOBS 
############################################################################################# 
############################################################################################# 

Recalling what are the different statobs lines 
Statobs_1 =     ML1p_1        ML1p_2        ML1p_3        ML1p_4       ML2p_1.2      ML2p_1.3      ML2p_1.4      ML2p_2.3      ML2p_2.4      ML2p_3.4     ML3p_1.2.3    ML3p_1.2.4    ML3p_1.3.4    ML3p_2.3.4      HWm_1         HWm_2         HWm_3         HWm_4         HWv_1         HWv_2         HWv_3         HWv_4        HBm_1.2       HBm_1.3       HBm_1.4       HBm_2.3       HBm_2.4       HBm_3.4       HBv_1.2       HBv_1.3       HBv_1.4       HBv_2.3       HBv_2.4       HBv_3.4       FST1m_1       FST1m_2       FST1m_3       FST1m_4       FST1v_1       FST1v_2       FST1v_3       FST1v_4      FST2m_1.2     FST2m_1.3     FST2m_1.4     FST2m_2.3     FST2m_2.4     FST2m_3.4     FST2v_1.2     FST2v_1.3     FST2v_1.4     FST2v_2.3     FST2v_2.4     FST2v_3.4      NEIm_1.2      NEIm_1.3      NEIm_1.4      NEIm_2.3      NEIm_2.4      NEIm_3.4      NEIv_1.2      NEIv_1.3      NEIv_1.4      NEIv_2.3      NEIv_2.4      NEIv_3.4     AMLm_1.2.3    AMLm_2.1.3    AMLm_3.1.2    AMLm_1.2.4    AMLm_2.1.4    AMLm_4.1.2    AMLm_1.3.4    AMLm_3.1.4    AMLm_4.1.3    AMLm_2.3.4    AMLm_3.2.4    AMLm_4.2.3    AMLv_1.2.3    AMLv_2.1.3    AMLv_3.1.2    AMLv_1.2.4    AMLv_2.1.4    AMLv_4.1.2    AMLv_1.3.4    AMLv_3.1.4    AMLv_4.1.3    AMLv_2.3.4    AMLv_3.2.4    AMLv_4.2.3   FST3m_1.2.3   FST3m_1.2.4   FST3m_1.3.4   FST3m_2.3.4   FST3v_1.2.3   FST3v_1.2.4   FST3v_1.3.4   FST3v_2.3.4   FST4m_1.2.3.4  FST4v_1.2.3.4   F3m_1.2.3     F3m_2.1.3     F3m_3.1.2     F3m_1.2.4     F3m_2.1.4     F3m_4.1.2     F3m_1.3.4     F3m_3.1.4     F3m_4.1.3     F3m_2.3.4     F3m_3.2.4     F3m_4.2.3     F3v_1.2.3     F3v_2.1.3     F3v_3.1.2     F3v_1.2.4     F3v_2.1.4     F3v_4.1.2     F3v_1.3.4     F3v_3.1.4     F3v_4.1.3     F3v_2.3.4     F3v_3.2.4     F3v_4.2.3    F4m_1.2.3.4   F4m_1.3.2.4   F4m_1.4.2.3   F4v_1.2.3.4   F4v_1.3.2.4   F4v_1.4.2.3  

Summary for Statobs = 1 
       S1          S2          S3          S4          S5          S6   
 Min.   :7   Min.   :5   Min.   :6   Min.   :8   Min.   :5   Min.   :6  
 1st Qu.:7   1st Qu.:5   1st Qu.:6   1st Qu.:8   1st Qu.:5   1st Qu.:6  
 Median :7   Median :5   Median :6   Median :8   Median :5   Median :6  
 Mean   :7   Mean   :5   Mean   :6   Mean   :8   Mean   :5   Mean   :6  
 3rd Qu.:7   3rd Qu.:5   3rd Qu.:6   3rd Qu.:8   3rd Qu.:5   3rd Qu.:6  
 Max.   :7   Max.   :5   Max.   :6   Max.   :8   Max.   :5   Max.   :6  
       S7          S8           S9           S10          S11          S12     
 Min.   :6   Min.   :31   Min.   :117   Min.   :73   Min.   :49   Min.   :356  
 1st Qu.:6   1st Qu.:31   1st Qu.:117   1st Qu.:73   1st Qu.:49   1st Qu.:356  
 Median :6   Median :31   Median :117   Median :73   Median :49   Median :356  
 Mean   :6   Mean   :31   Mean   :117   Mean   :73   Mean   :49   Mean   :356  
 3rd Qu.:6   3rd Qu.:31   3rd Qu.:117   3rd Qu.:73   3rd Qu.:49   3rd Qu.:356  
 Max.   :6   Max.   :31   Max.   :117   Max.   :73   Max.   :49   Max.   :356  
      S13           S14           Prob            Win      Prior_error    
 Min.   :183   Min.   :148   Min.   :0.437   Min.   :12   Min.   :0.7501  
 1st Qu.:183   1st Qu.:148   1st Qu.:0.437   1st Qu.:12   1st Qu.:0.7501  
 Median :183   Median :148   Median :0.437   Median :12   Median :0.7501  
 Mean   :183   Mean   :148   Mean   :0.437   Mean   :12   Mean   :0.7501  
 3rd Qu.:183   3rd Qu.:148   3rd Qu.:0.437   3rd Qu.:12   3rd Qu.:0.7501  
 Max.   :183   Max.   :148   Max.   :0.437   Max.   :12   Max.   :0.7501  



Winner scenarios for Statobs = 1 
[1] 12



  Win.Scen.ID occur
1          12     1

Mean vote numbers for each statobs 

Statobs # 1 
   Scenario Mean.Votes
1         1          7
2         2          5
3         3          6
4         4          8
5         5          5
6         6          6
7         7          6
8         8         31
9         9        117
10       10         73
11       11         49
12       12        356
13       13        183
14       14        148


Final results without threshold:
Global mean number of votes over all statobs:
   Scenario Mean.Votes
1         1          7
2         2          5
3         3          6
4         4          8
5         5          5
6         6          6
7         7          6
8         8         31
9         9        117
10       10         73
11       11         49
12       12        356
13       13        183
14       14        148

### End of Results ###
############################################################################################# 
############################################################################################# 
########### OTHER PRESENTATION OF FINAL RESULTS WITHOUT ANY THRESHOLD ###################### 
############################################################################################# 
############################################################################################# 

DataFrame for mean number of votes with TotalTrees row 
     Scenario Statobs1
1           1        7
2           2        5
3           3        6
4           4        8
5           5        5
6           6        6
7           7        6
8           8       31
9           9      117
10         10       73
11         11       49
12         12      356
13         13      183
14         14      148
15 TotalTrees     1000
nDataFrame for mean fraction of votes with Total% row 
        Scenario Statobs1
1              1    0.007
2              2    0.005
3              3    0.006
4              4    0.008
5              5    0.005
6              6    0.006
7              7    0.006
8              8    0.031
9              9    0.117
10            10    0.073
11            11    0.049
12            12    0.356
13            13    0.183
14            14    0.148
15 TotalFraction    1.000

### End of Results ###
############################################################################################# 
############################################################################################# 
########### OTHER PRESENTATION OF FINAL RESULTS USING A DEFINED THRESHOLD          ########## 
############################################################################################# 
############################################################################################# 
ntree = 1000 
results_threshold_fraction_trees= 0.05 
threshold in min number of trees = 50 

Sub-dataframe for the scenarios with mean number of votes >  50 
   Scenario Statobs1
9         9      117
10       10       73
12       12      356
13       13      183
14       14      148

Sub-dataframe for the scenarios with mean fraction of votes >  0.05 
   Scenario Statobs1
9         9    0.117
10       10    0.073
12       12    0.356
13       13    0.183
14       14    0.148

Sum of the nbre of votes for scenario relaining after threshold 
           Column Sum
Statobs1 Statobs1 877

Sum of the nbre of votes for scenario relaining after threshold 
           Column   Sum
Statobs1 Statobs1 0.877
############################################################################################# 
Drawing figures for the last of the i.run = 1 
############################################################################################# 
Press <ENTER> to Continue
THREE ILLUSTRATIVE GRAPHICS have been produced and saved in three different files: FALSEFile named prior_errors_vs_number_of_trees.png: Graphic providing prior error rates for forests with different number of trees and computed using an Out-of-Bag procedure, e.g. Fig. 3 in Pudlo et al. 2016 
File named graph_lda.pdf = LDA projections of the reference table for the different scenarios plus the observed dataset cf. black star in the figure 
File name graph_varImpPlot.pdf = the contributions of the 30 most important statistics to the RF (e.g. Fig. S6 and Fig. S7 in Pudlo et al. 2016) 
